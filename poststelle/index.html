<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>📬 FSA Poststelle – Control & GitHub Push System</title>
  <style>
    :root{
      --bg:#0b1220; --panel:#111b2e; --line:#1f2b44;
      --text:#e6f2ff; --muted:#9db4d6;
      --ok:#1ecb6c; --warn:#ffcb5c; --err:#ff5c5c;
      --card-shadow:0 8px 30px rgba(0,0,0,.35); --radius:12px;
    }
    html,body{height:100%;}
    body{
      margin:0;
      background:linear-gradient(180deg,#0b1220 0%,#09101d 100%);
      color:var(--text);
      font:14px/1.45 system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif;
      display:flex;justify-content:center;padding:24px;
    }
    .container{
      max-width:1200px;width:100%;display:grid;
      grid-template-columns:2fr 1fr;grid-gap:20px;
    }
    h1{color:#38bdf8;margin-bottom:8px;text-align:center;}
    h2,h3{margin:0 0 8px;color:#e6f2ff}
    .panel{
      background:var(--panel);
      padding:18px;border-radius:var(--radius);
      box-shadow:var(--card-shadow);
      margin-bottom:20px;border:1px solid var(--line);
    }
    .muted{color:var(--muted)}
    .status-led{font-weight:700}
    .ok{color:var(--ok)}.warn{color:var(--warn)}.err{color:var(--err)}
    .log{
      background:#0f1a2e;border:1px dashed #22365d;
      color:#9db4d6;padding:12px;border-radius:10px;
      white-space:pre-wrap;font-family:ui-monospace,Consolas;
      height:220px;overflow:auto;
    }
    footer{text-align:center;color:#93a8cc;font-size:12px;margin-top:10px;}
    button{
      border:none;padding:10px;border-radius:8px;cursor:pointer;
      font-weight:600;transition:.2s;min-width:160px;
    }
    button:hover{opacity:.9;transform:translateY(-1px);}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;font-weight:700;border:1px solid var(--line)}
  </style>
</head>
<body>

  <!-- 🔸 Live Build-Status -->
  <div id="build-status" style="padding:10px; text-align:center; font-weight:bold; background:#0f1a2e; border:1px solid var(--line); border-radius:10px; max-width:1200px; margin:-6px auto 16px;">
    ⏳ Build-Status wird geladen …
  </div>

  <div style="width:100%;">
    <h1>📬 FSA Poststelle – Control & GitHub Push System</h1>
    <div class="container">
      <div>
        <!-- Token + Repo -->
        <div id="slot-token" class="panel"></div>

        <!-- Aktionen -->
        <div id="slot-patch" class="panel"></div>

        <!-- 🔒 Compliance / Gesetz -->
        <div id="compliance-panel" class="panel">
          <h2>🛡️ S-O-S Gesetz & Compliance</h2>
          <p class="muted">Vor jedem Deploy prüft die Poststelle, ob die Änderungen den S-O-S TPS-Regeln entsprechen.</p>
          <p>Status: <span id="compliance-status" class="pill">Prüfung ausstehend …</span></p>
          <div id="registry-summary" class="muted" style="margin-top:8px;">—</div>
          <div id="registry-list" style="margin-top:12px;"></div>
        </div>

        <!-- Log -->
        <div class="panel">
          <h2>📜 Live-Log</h2>
          <div id="log" class="log">Poststelle initialisiert …</div>
        </div>
      </div>

      <!-- rechte Sidebar -->
      <div>
        <!-- 📦 Backup Trigger -->
        <div id="slot-modules" class="panel">
          <h2>🧭 Backup-System</h2>
          <p class="muted">Erstellt automatisch die stabile Fallback-Version der Poststelle im Repo.</p>
          <button onclick="deployBackup()">📦 Deploy Backup v1.0</button>
        </div>

        <!-- Schnellzugriff -->
        <div class="panel">
          <h3>🔗 Schnellzugriff</h3>
          <p><a href="../docs/sos-gesetz-v1.2.html" target="_blank">📜 S-O-S Gesetz v1.2</a></p>
          <p><a href="https://github.com/Adler-FSA/Lp-Generator/actions" target="_blank">⚙️ GitHub Actions</a></p>
        </div>
      </div>
    </div>
    <footer>© 2025 FSA · Poststelle v3.8.0 · Slot-Architektur + Compliance-Layer</footer>
  </div>

  <!-- Modular Scripts -->
  <script src="./js/log.js"></script>
  <script src="./js/healthcheck.js"></script>
  <script src="./js/token.js"></script>
  <script src="./js/actions.js"></script>
  <script src="./js/modules.js"></script>
  <script src="./js/paragraph-registry.js"></script>
  <script src="./js/check-law.js"></script>
  <script src="./js/init.js"></script>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./service-worker.js')
        .then(reg => console.log('✅ Service Worker aktiv:', reg.scope))
        .catch(err => console.error('❌ Service Worker Fehler:', err));
    }
  </script>
</body>
</html>
