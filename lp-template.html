<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>üöÄ LP Template Core v1.2.0</title>
<style>
  body { margin:0; font-family:Arial,sans-serif; background:#000; color:#fff; }
  header { position:fixed; top:0; width:100%; background:rgba(0,0,0,0.6); padding:20px; text-align:center; }
  h1 { margin-top:100px; font-size:2.5rem; text-align:center; }
  .quote { font-style:italic; margin:20px auto; max-width:600px; text-align:center; color:#d4af37; }
  #kino { margin:40px auto; max-width:900px; position:relative; padding-top:56.25%; }
  #kino iframe, #kino img { position:absolute; top:0; left:0; width:100%; height:100%; border:none; border-radius:12px; object-fit:cover; }
  #musikBtn { position:fixed; bottom:20px; right:20px; padding:10px 16px; background:#d4af37; color:#000; border:none; border-radius:30px; cursor:pointer; font-weight:bold; }
  #approvalBanner { text-align:center; background:#660000; padding:15px; margin:20px auto; max-width:600px; border-radius:8px; font-weight:bold; }
  #emailBox { text-align:center; margin:30px auto; font-size:1.2rem; }
  #emailBox button { margin:10px; padding:10px 18px; border:none; border-radius:6px; background:#d4af37; cursor:pointer; font-weight:bold; }
</style>
</head>
<body>
<header>üåê Finanzielle Souver√§nit√§ts Akademie ‚Äì LP Generator v1.2.0</header>
<h1>Dein Geld.<br><span style="color:#1cc2a0">Deine Freiheit.</span></h1>
<div id="quotes"></div>
<div id="kino"></div>
<audio id="bgMusic" loop></audio>
<button id="musikBtn">üéµ Start</button>
<div id="approval"></div>
<div id="emailBox"></div>
<script>
  async function loadJSON(url){
    try{ const r=await fetch(url); return await r.json(); }
    catch(e){ console.error("Fehler beim Laden:",url); return {}; }
  }

  function getParam(name){
    const urlParams=new URLSearchParams(window.location.search);
    return urlParams.get(name);
  }

  // Quotes
  loadJSON('quotes.json').then(data=>{
    const qDiv=document.getElementById('quotes');
    if(data.quotes){data.quotes.forEach(q=>{
      const el=document.createElement('div'); el.className='quote'; el.textContent=q; qDiv.appendChild(el);
    });}
  });

  // Settings
  loadJSON('settings.json').then(settings=>{
    if(!settings.approved){
      document.getElementById('approval').innerHTML='<div id="approvalBanner">‚è≥ Diese LP ist noch nicht freigegeben ‚Äì Eintrag erfolgt nach Qualit√§tspr√ºfung.</div>';
    }

    if(settings.mode === 'slideshow'){
      loadJSON('slideshow.json').then(data=>{
        let idx=0;
        const container=document.getElementById('kino');
        const img=document.createElement('img'); container.appendChild(img);
        function showNext(){ img.src=data.images[idx]; idx=(idx+1)%data.images.length; }
        if(data.images){ showNext(); setInterval(showNext,(data.interval||15)*1000); }
      });
    } else {
      document.getElementById('kino').innerHTML='<iframe src="https://www.youtube.com/embed/miWBKSszEIw?autoplay=1&mute=1&loop=1"></iframe>';
    }

    loadJSON('music.json').then(music=>{
      const player=document.getElementById('bgMusic');
      if(music.tracks && music.tracks.length>0){ player.src=music.tracks[0]; }
      const btn=document.getElementById('musikBtn');
      btn.onclick=()=>{
        if(player.paused){
          player.play().then(()=>btn.textContent="üéµ Stop").catch(()=>alert("‚ö†Ô∏è Autoplay blockiert ‚Äì bitte manuell starten."));
        } else { player.pause(); btn.textContent="üéµ Start"; }
      };
    });
  });

  // Emails anhand ID
  const lpID=getParam("id");
  loadJSON('emails.json').then(data=>{
    if(data.emails){
      const found=data.emails.find(e=>e.id===lpID);
      if(found){
        if(found.approved){
          document.getElementById('emailBox').innerHTML=`üìß Kontakt: <strong>${found.email}</strong><br><button onclick="window.location='mailto:${found.email}'">E-Mail senden</button>`;
        } else {
          document.getElementById('approval').innerHTML='<div id="approvalBanner">‚è≥ Diese LP ist noch nicht freigegeben ‚Äì Eintrag erfolgt nach Qualit√§tspr√ºfung.</div>';
        }
      } else {
        document.getElementById('emailBox').innerHTML="<p style='color:red'>‚ùå Keine Partner-E-Mail f√ºr diese ID gefunden.</p>";
      }
    }
  });
</script>
</body>
</html>