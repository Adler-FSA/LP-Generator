<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>LP-Generator v2.4.1 ‚Äì Workbench (SAFE)</title>
<style>
  /* Dashboard Basis */
  #ws-dashboard {
    position: fixed;
    bottom: 12px;
    right: 12px;
    background: linear-gradient(135deg, #0f172a, #1e293b);
    color: #e2e8f0;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 10px;
    padding: 12px 16px;
    box-shadow: 0 8px 28px rgba(0,0,0,0.35);
    font-family: system-ui, Segoe UI, Roboto, sans-serif;
    font-size: 13.5px;
    line-height: 1.4;
    z-index: 9999;
    transition: all .3s ease;
  }

  #ws-dashboard button {
    background: #38bdf8;
    color: #0f172a;
    border: none;
    border-radius: 6px;
    padding: 6px 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all .25s ease;
    margin-left: 10px;
  }

  #ws-dashboard button:hover {
    background: #0ea5e9;
    color: #fff;
    transform: scale(1.05);
  }

  #ws-dashboard b { color: #22d3ee; }

  #ws-dashboard:before {
    content: "üß©";
    margin-right: 6px;
    opacity: 0.85;
  }

  @keyframes dots {
    0% {content: ".";}
    33% {content: "..";}
    66% {content: "...";}
    100% {content: ".";}
  }

  #ws-state::after {
    animation: dots 1.5s steps(3, end) infinite;
  }

  .status-ok   { color:#22c55e !important; }  /* Gr√ºn: Aktiv */
  .status-warn { color:#f59e0b !important; }  /* Gelb: Warten */
  .status-err  { color:#ef4444 !important; }  /* Rot: Fehler */
</style>
</head>

<body style="background:#0b0f14; color:#e5e7eb; font-family:system-ui, sans-serif;">
  <div id="ws-dashboard">
    <div>Module: <b id="ws-modules">ReBind, UI, Check, Console</b></div>
    <div>Status: <b id="ws-state" class="status-warn">Initialisiere...</b></div>
    <button id="ws-restart">Neu-Scan</button>
  </div>

<script>
(() => {
  const state = document.getElementById('ws-state');
  const modules = document.getElementById('ws-modules');
  const restart = document.getElementById('ws-restart');

  // Initialzustand
  state.textContent = 'Scan l√§uft...';
  state.className = 'status-warn';
  modules.textContent = 'Module: ReBind, UI, Check, Console';

  // Ereignisse abfangen
  window.addEventListener('WerkstattReady', () => {
    state.textContent = 'Aktiv';
    state.className = 'status-ok';
  });

  window.addEventListener('WerkstattError', () => {
    state.textContent = 'Fehler';
    state.className = 'status-err';
  });

  // Manuell neu starten
  restart.onclick = () => {
    state.textContent = 'Neu-Scan l√§uft...';
    state.className = 'status-warn';
    console.clear();
    document.dispatchEvent(new CustomEvent('WerkstattRebindInit'));
    setTimeout(checkGithubPages, 1500);
  };

  // Auto-Check auf GitHub-Pages Erreichbarkeit
  async function checkGithubPages() {
    const dashboardStatus = document.getElementById('ws-state');
    const modules = document.getElementById('ws-modules');
    try {
      const resp = await fetch('https://adler-fsa.github.io/', { cache: 'no-store' });
      if (!resp.ok) throw new Error('Seite offline oder im Neuaufbau');

      const html = await resp.text();
      if (html.includes('404') || html.includes('not found')) {
        dashboardStatus.textContent = '‚ö†Ô∏è GitHub Pages im Neuaufbau ‚Äì bitte 2‚Äì3 Minuten warten';
        dashboardStatus.className = 'status-warn';
        modules.textContent = 'Module: ReBind, UI, Check, Console (Standby)';
      } else {
        console.log('‚úÖ GitHub Pages online und aktiv.');
        document.dispatchEvent(new CustomEvent('WerkstattReady'));
      }
    } catch (err) {
      dashboardStatus.textContent = 'üö´ GitHub Pages aktuell nicht erreichbar';
      dashboardStatus.className = 'status-err';
      modules.textContent = 'Module: Offline ‚Äì Verbindung pr√ºfen';
      console.warn('Werkstatt: GitHub Pages Error ‚Üí', err.message);
    }
  }

  // Erststart beim Laden
  checkGithubPages();
})();
</script>
</body>
</html>
